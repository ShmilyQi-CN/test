## 平衡三进制（Balanced Ternary）

**目录**

- [平衡三进制（Balanced Ternary）](#平衡三进制balanced-ternary)
- [转换算法](#转换算法)
- [练习题](#练习题)

有一个非标准的但仍旧可以运行的**数字系统**。它的特征是数字可以有$-1,0$ 和 $1$ 中的一个值。因此，它的基数是 $3$ (因为有三个可能的值)。由于将 $-1$ 写成数字不方便，我们将使用字母 $Z$ 来代替 $-1$ 。如果你认为这是一个相当奇怪的系统,看看这张图片,这就是一台使用它的计算机。

![](./images/balanced-ternary1.jpg)

这里有几个例子:

$$
\begin{array}{ll}
0 & \text{0}\\
1 & \text{1}\\
2 & \text{1Z}\\
3 & \text{10}\\
4 & \text{11}\\
5 & \text{1ZZ}\\
6 & \text{1Z0}\\
7 & \text{1Z1}\\
8 & \text{10Z}\\
9 & \text{100}\\
\end{array}
$$

该系统允许我们在不前置负号的情况下写负数:任何正数的数字倒转即可( $Z$ 变成 $1$ , $1$ 变成 $Z$ )。

$$
\begin{array}{ll}
-1 & \text{Z}\\
-2 & \text{Z1}\\
-3 & \text{Z0}\\
-4 & \text{ZZ}\\
-5 & \text{Z11}\\
\end{array}
$$

很容易就观察到，负数从 $Z$ 开始，正数从 $1$ 开始。

## 转换算法

在平衡三进制中，一个给定的数可以通过在普通三进制中临时表示来表示。当value是标准三进制时，其数字为 $0$ 、$1$ 或 $2$ 。从最低的数字开始迭代，我们可以安全地跳过任何的 $0$ 和 $1$ ，但是 $2$ 应该变成 $Z$ ，下一位数字加上 $1$ 。数字 $3$ 应该在相同的条件下转换为 $0$ 。

这些数字最初不会出现在数字中，但是在增加了一些 $2$ 之后就会出现。

**Example 1:** 把 $64$ 换算成平衡三进制。

首先，我们用正规三进制数来重写这个数:

$$64_{10} = 02101_{3}$$

让我们从对整个数影响最小的数字(最右边)进行处理：

- $101$ 被跳过（因为在平衡三进制中允许 $0$ 和 $1$ ）；
- $2$ 变成了 $Z$ ，它左边的数字加 $1$ ，得到 $1Z101_{}$ ；
- $1$ 被跳过，得到 $1Z101_{}$ 。

最终的结果是 $1Z101$。

我们再把它转换回十进制:

$$1Z101 = 81 \cdot 1 + 27 \cdot (-1) + 9 \cdot 1 + 3 \cdot 0 + 1 \cdot 1 = 64_{10}
$$

**Example 2:**   把 $237$ 换算成平衡三进制。

首先，我们用正规三进制数来重写这个数:

$$237_{10} = 22210_{3}$$

- $0$ 和 $1$ 被跳过(因为在平衡三元中允许 $0$ 和 $1$ )；
- $2$ 变成了 $Z$ ，左边的数字加 $1$ ，得到 $23Z10$ ；
- $3$ 变成 $0$ ，左边的数字加 $1$ ，得到 $30Z10$ ；
- $3$ 变成 $0$ ，左边的数字(默认是 $0$ )加 $1$ ，得到 $100Z10$ ；
- $1$ 被跳过，得到 $100Z10_{}$ 。

最终的结果是 $100Z10$ 。

我们再把它转换回十进制：

$$100Z10 = 243 \cdot 1 + 81 \cdot 0 + 27 \cdot 0 + 9 \cdot (-1) + 3 \cdot 1 + 1 \cdot 0 = 237_{10}
$$


## 练习题

<a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=12917&amp;rd=15837">Topcoder SRM 604, Div1-250</a>

**本页面部分内容译自博文 [Бинарное возведение в степень](http://e-maxx.ru/algo/binary_pow) 与其英文翻译版 [Binary Exponentiation](https://cp-algorithms.com/algebra/binary-exp.html) 。其中俄文版版权协议为 Public Domain + Leave a Link；英文版版权协议为 CC-BY-SA 4.0。**


